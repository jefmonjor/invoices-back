# =================================================================
# PRODUCTION ENVIRONMENT VARIABLES - INVOICES BACKEND
# =================================================================
# IMPORTANTE: Este archivo debe ser copiado como .env.production y personalizado
# NUNCA versionar el archivo .env.production real en Git
#
# Instrucciones completas: ver FREE_SERVICES_SETUP.md
# =================================================================

# =================================================================
# JWT CONFIGURATION
# =================================================================
# Generar con: openssl rand -base64 64 | tr -d '\n'
JWT_SECRET=CHANGE_ME_generate_with_openssl_rand_base64_64_minimum_64_chars
JWT_EXPIRATION_MS=3600000
JWT_ISSUER=invoices-backend

# =================================================================
# CORS (Frontend URLs permitidas - Vercel)
# =================================================================
CORS_ALLOWED_ORIGINS=https://invoices-frontend-vert.vercel.app,https://*.vercel.app
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_MAX_AGE=3600

# =================================================================
# NEON POSTGRESQL - Connection Strings (Serverless)
# =================================================================
# Obtener de: https://console.neon.tech/
# Formato: postgresql://user:password@host/database?sslmode=require
#
# Crear 4 databases en Neon:
# - userdb
# - invoicedb
# - documentdb
# - tracedb

USER_DB_URL=postgresql://neondb_owner:YOUR_PASSWORD@ep-xxx.eu-west-2.aws.neon.tech/userdb?sslmode=require&channel_binding=require
INVOICE_DB_URL=postgresql://neondb_owner:YOUR_PASSWORD@ep-xxx.eu-west-2.aws.neon.tech/invoicedb?sslmode=require&channel_binding=require
DOCUMENT_DB_URL=postgresql://neondb_owner:YOUR_PASSWORD@ep-xxx.eu-west-2.aws.neon.tech/documentdb?sslmode=require&channel_binding=require
TRACE_DB_URL=postgresql://neondb_owner:YOUR_PASSWORD@ep-xxx.eu-west-2.aws.neon.tech/tracedb?sslmode=require&channel_binding=require

# =================================================================
# CLOUDFLARE R2 (S3-Compatible Storage)
# =================================================================
# Setup: https://dash.cloudflare.com/
# Dashboard → R2 → Create bucket: "invoices-documents"
# Manage R2 API Tokens → Create API Token
#
# FREE TIER: 10 GB storage + 1M uploads/month + unlimited downloads

R2_ENDPOINT=https://YOUR_ACCOUNT_ID.r2.cloudflarestorage.com
R2_ACCESS_KEY_ID=YOUR_R2_ACCESS_KEY_ID
R2_SECRET_ACCESS_KEY=YOUR_R2_SECRET_ACCESS_KEY
R2_BUCKET_NAME=invoices-documents
R2_REGION=auto

# =================================================================
# UPSTASH REDIS (Event Streaming con Redis Streams)
# =================================================================
# Setup: https://console.upstash.com/redis
# Create Redis Database: "invoices-events"
# Region: eu-west-1 (Ireland) o us-east-1
# Type: Pay as you go (free tier)
#
# FREE TIER: 10,000 commands/day (mucho más generoso que Kafka)
#
# Alternativa: Redis Cloud (https://redis.com/try-free/)
# - 30 MB storage gratis
# - Sin límite de comandos
#
# Redis Streams que se crearán automáticamente:
# - invoice-events: Eventos de facturas
# - invoice-events-dlq: Dead Letter Queue para eventos fallidos

# Redis Connection (Upstash Redis)
REDIS_HOST=eu-west-1-optimistic-lemur-12345.upstash.io
REDIS_PORT=6379
REDIS_PASSWORD=YOUR_UPSTASH_REDIS_PASSWORD
REDIS_SSL=true

# Redis Streams Configuration
REDIS_STREAM_INVOICE_EVENTS=invoice-events
REDIS_STREAM_INVOICE_DLQ=invoice-events-dlq
REDIS_CONSUMER_GROUP=trace-group
REDIS_CONSUMER_NAME=trace-consumer

# =================================================================
# EUREKA (Opcional - Deshabilitado en Fly.io)
# =================================================================
EUREKA_CLIENT_ENABLED=false
EUREKA_USERNAME=eureka-admin
EUREKA_PASSWORD=not-used-in-production

# =================================================================
# LOGGING
# =================================================================
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=DEBUG

# =================================================================
# SPRING PROFILES
# =================================================================
SPRING_PROFILES_ACTIVE=prod

# =================================================================
# DEPLOYMENT INFO
# =================================================================
# Stack completamente GRATUITO:
#
# Frontend: Vercel (gratis)
# Backend: Render.com (750h/mes gratis por servicio)
#   - Gateway Service
#   - User Service
#   - Invoice Service
#   - Document Service
#   - Trace Service
#
# Base de datos: Neon PostgreSQL (serverless, gratis hasta 3GB)
# Storage: Cloudflare R2 (gratis hasta 10GB)
# Event Streaming: Upstash Redis (gratis 10k commands/day)
#
# Alternativa para backend:
# - Fly.io (3 apps gratis con 256MB RAM c/u)
# - Railway.dev ($5 crédito mensual gratis)
# =================================================================
